#
# deptrac.yaml
#
# @see https://qossmic.github.io/deptrac/configuration
# @see https://codesoapbox.dev/ports-adapters-aka-hexagonal-architecture-explained

deptrac:
  paths:
    - ../../src

  exclude_files:
    - '#.*Test.*#'
    - '#.*Admin.*#'

  layers:

    ### Application ###
    # DRIVING models
    # User or console input/output values

    -
      name: Application
      collectors:
        -
          type: className
          value: App.*\\Application\\.*

    ### Domain ###
    # No dependencies or tech
    # Business model and rules only

    -
      name: Domain
      collectors:
        -
          type: className
          value: App.*\\Domain\\.*

    ### Infrastructure ###
    # DRIVERS models
    # Server, framework, dependencies

    -
      name: Infrastructure
      collectors:
        -
          type: className
          value: App.*\\Infrastructure\\.*

    -
      name: Framework_Symfony
      collectors:
        -
          type: className
          value: Symfony.*

    -
      name: Framework_Doctrine
      collectors:
        -
          type: className
          value: Doctrine.*

    -
      name: Framework_Monolog
      collectors:
        -
          type: className
          value: Monolog.*

  # RULES
  ruleset:
    Application:
      - Domain
      - Framework_Symfony # @todo remove this ?
    Domain:
      - Framework_Doctrine
    Infrastructure:
      - Application
      - Domain
      - Framework_Symfony
      - Framework_Doctrine
      - Framework_Monolog

  # formatters:
  #   graphviz:
  #     groups:
  #       Entrypoints:
  #         - Controllers
  #       Persistence:
  #         - Entities
