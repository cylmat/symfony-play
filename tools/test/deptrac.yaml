# deptrac.yaml
# @see https://qossmic.github.io/deptrac/configuration

deptrac:
  paths:
    - ../../src

  exclude_files:
    - '#.*Test.*#'

  layers:
    # Doctrine
    -
      name: DoctrineRepository
      collectors:
        -
          type: className
          value: .*ServiceEntityRepository
    -
      name: DoctrineManager
      collectors:
        -
          type: className
          value: .*ManagerRegistry

    -
      name: Action
      collectors:
        -
          type: className
          value: .*Action.*
    -
      name: Controller
      collectors:
        -
          type: className
          value: .*Controller.*
    -
      name: Manager
      collectors:
        -
          type: className
          value: .*Manager.*
    -
      name: Repository
      collectors:
        -
          type: className
          value: .*Repository.*
    -
      name: Service
      collectors:
        -
          type: className
          value: .*Service.*

  ruleset:
    Controller:
      - Action
    Action:
      - Manager
    Manager:
      - Service
      - Repository
    Service:
      - Repository
    Repository:
      - DoctrineRepository
      - DoctrineManager

  formatters:
    graphviz:
      groups:
        Entrypoints:
          - Controllers
          - Commands
        Persistence:
          - Entities
          - Repositories